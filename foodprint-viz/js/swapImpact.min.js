/*! project-name v0.0.1 | (c) 2020 YOUR NAME | MIT License | http://link-to-your-git-repo.com */
function addMealImpact(){""===currentSwapedMeal||lastestSwapIsSet||(setLatestSwap(currentSwap,currentSwapedMeal),lastestSwapIsSet=!0),updateMeal(),getCurrentGlobalFoodprint(),getCurrentGlobalFI()}function updateMeal(){currentFoodprintDetail.forEach(t=>{t.mealId===updatedMeal&&(t.setSwapFoodprint=[0,0,0,0,0],t.newSwapFoodprint=[0,0,0,0,0],t.mealFoodprint=getMealFoodprint(updatedMeal,currentMenu))})}function calculateSwapImpact(){currentSwapedMeal===updatedMeal||lastestSwapIsSet||(setLatestSwap(latestSwap,updatedMeal),lastestSwapIsSet=!0),newSwapImpact=addNewSwap(),lastestSwapIsSet=!1,getCurrentGlobalFoodprint();const t=getSwapImpact(newSwapImpact);getCurrentGlobalFI();let e=(getNewFI(newSwapImpact)-currentGlobalFI)/currentGlobalFI*100;lastestSwapIsSet=!1,showSwapImpact(t,newSwapImpact,e)}function showSwapImpact(t,e,a){d3.select("#tooltip-swap-impact .tooltip--fact").classed("hidden",!0),d3.select("#tooltip-swap-impact .tooltip--recipe").classed("hidden",!0);let o="",s="";if(a<0){const t=getFunFacts(e),a=t[getfunfactRandomNumber(t)];o=a.icon,s=a.titleShort,d3.select("#tooltip-swap-impact").classed("positive-impact",!0),d3.select("#tooltip-swap-impact .swap-title--subtext").text(a.title1),d3.select("#tooltip-swap-impact .swap-title--subtext").append("span").attr("class","swap-title--subtext-emphasis").text(Math.abs(a.funFactNumber)+a.titleEmphasis),d3.select("#tooltip-swap-impact .swap-title--subtext").append("span").attr("class","swap-title--subtext-end").text(a.title2),d3.select("#tooltip-swap-impact .swap-title--subtext").classed("hidden",!1),""!==a.footnote?(d3.select(".impact-footnote").classed("hidden",!1),d3.select(".impact-footnote-text").text(a.footnote),d3.select(".impact-footnote-source").text(a.source)):d3.select(".impact-footnote").classed("hidden",!0),void 0!==currentSwap.recipeLabel&&(d3.select("#tooltip-swap-impact .tooltip--recipe").classed("hidden",!1),d3.select("#tooltip-swap-impact .recipe a").attr("href",currentSwap.recipeUrl),d3.select("#tooltip-swap-impact .recipe a").text(currentSwap.recipeLabel),d3.select("#tooltip-swap-impact .recipe-source a").attr("href",currentSwap.recipeCreatorUrl),d3.select("#tooltip-swap-impact .recipe-source a").text(currentSwap.recipeCreator))}else o="earth-sad",s="Womp Womp...",d3.select("#tooltip-swap-impact").classed("positive-impact",!1),d3.select(".impact-footnote").classed("hidden",!0),d3.select("#tooltip-swap-impact .swap-title--subtext").classed("hidden",!0);const i=a<0?"decreases":"increases";d3.select("#tooltip-swap-impact .swap-title--icon").attr("class","swap-title--icon "+o),d3.select("#tooltip-swap-impact .swap-title--text").text(s),d3.select("#tooltip-swap-impact .summary-swap").text(currentSwap.impactLabel),d3.select("#tooltip-swap-impact .summary-impact").text(i),d3.select("#tooltip-swap-impact .summary-result").text(Math.abs(a).toFixed(0)),t.forEach((t,e)=>{const a=t>0?"+":"-";d3.select("#tooltip-swap-impact .detail--"+categories[e].class+" .detail-impact").text(a+Math.abs(t.toFixed(0)))}),void 0!==currentSwap.funFact&&(d3.select("#tooltip-swap-impact .tooltip--fact").classed("hidden",!1),d3.select("#tooltip-swap-impact .fact").text(currentSwap.funFact),d3.select("#tooltip-swap-impact .source").text(currentSwap.funFactSource)),d3.select("#tooltip-swap-impact").classed("visible",!0).classed("show-content",!0)}function getfunfactRandomNumber(t){let e=Math.floor(Math.random()*t.length);for(;t[e].funFactNumber<t[e].minNumber;)e=Math.floor(Math.random()*t.length);return e}function addNewSwap(){let t=[0,0,0,0,0];return currentFoodprintDetail.forEach(e=>{e.mealId===currentSwapedMeal&&(e.newSwapFoodprint=getSwapFoodprint(currentSwap),t=e.newSwapFoodprint)}),t}function getSwapImpact(t){let e=[0,0,0,0,0];return e.forEach((a,o)=>{e[o]=t[o]/currentGlobalFoodprint[o]*100}),e}function hideSwapImpact(){d3.select("#tooltip-swap-impact").classed("visible",!1).classed("show-content",!1),d3.select("#tooltip-swap-impact .tooltip--fact").classed("hidden",!0),d3.select("#tooltip-swap-impact .tooltip--recipe").classed("hidden",!0)}let funFactsSavings=[{key:"shower",icon:"shower",funFactFactor:16,impactIndex:2,funFactNumber:0,minNumber:10,titleShort:"You made it look easy",title1:"With this swap, you preserved the equivalentÂ of ",titleEmphasis:" showers",title2:" in water.*",footnote:" and assuming a 4 minutes shower with an average shower head delivering 4L per minute.",source:"7"},{key:"bath",icon:"bath",funFactFactor:75,impactIndex:2,funFactNumber:0,minNumber:10,titleShort:"Look at you !",title1:"You just saved the water of ",titleEmphasis:" luxurious baths",title2:".*",footnote:" and that the bath is filled with 75L of water.",source:"7"},{key:"land",icon:"tennis",funFactFactor:261,impactIndex:0,funFactNumber:0,minNumber:3,titleShort:"Go on rockstar !",title1:"This swap helped you protect a land surface comparable to ",titleEmphasis:" tennis courts",title2:".*",footnote:" and knowing that the dimensions of a tennis court are 23.77 x 11 meters.",source:""},{key:"car",icon:"car",funFactFactor:3940/3984,impactIndex:1,funFactNumber:0,minNumber:10,titleShort:"Can you believe this?",title1:"Your greenhouse gas emission reduction corresponds to ",titleEmphasis:"",title2:" car trips between New York and Los Angeles.*",footnote:" and knowing that a typical passenger car vehicle has a fuel economy of 9.35 km/L and emits 2.348 grams of CO2 per Litre.",source:"8"},{key:"money",icon:"piggy-bank",funFactFactor:1,impactIndex:4,funFactNumber:0,minNumber:20,titleShort:"Double win",title1:"This swap is not only good for the planet, it makes your wallet heavier with ",titleEmphasis:"$",title2:" *",footnote:".",source:""}];function getFunFacts(t){return funFactsSavings.forEach(e=>{e.funFactNumber=Math.round(Math.abs(t[e.impactIndex])/e.funFactFactor*52)}),funFactsSavings}